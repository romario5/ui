!function(){"use strict";let e="UIScheme:";let t=["div","p","span","a","b","i","u","sup","sub","font","meta","form","label","input","select","option","textarea","button","ul","ol","li","table","tbody","thead","tr","td","img","video","source","canvas","script","style","title","h1","h2","h3","h4","h5","h6","blockquote","br","hr","main","section","article"],s=/(^|\s)\w+/gi,n=/\.\w+[_\-\w\d]*/gi,r=/#\w+[_\-\w]*/gi;function i(n){let r=n.match(s);return null!==r&&r.length>0&&(r=r[0]),null===r||0===r.length?"div":(t.includes(r)||(i="Invalid tag name used: "+r,console.warn(e,i)),null==r?"div":r);var i}function o(e){let t=e.match(n);if(null!==t&&t.length>0)for(let e=0;e<t.length;e++)t[e]=a(t[e].slice(1));return null===t?[]:t}function l(e){let t=e.match(r);return null!==t&&t.length>0?t[0].slice(1).trim():""}function a(e){return function(e){return e.replace(/([A-Z]+)/g,",$1").replace(/^,/,"").split(",")}(e.replace(/\//g,"_").replace(" - ","-")).join("-").replace(/([a-zA-Z_-])\s+([a-zA-Z_\-\d])/g,"$1-$2").replace(/\s*-+\s*/gi,"-").replace(/-*_-*/gi,"_").toLowerCase()}const h=Symbol("selector"),d=Symbol("data"),c=Symbol("classesArray"),p=Symbol("className"),u=Symbol("id"),m=Symbol("tagName"),f=Symbol("events"),g=Symbol("extensions"),b=Symbol("element"),y=Symbol("stylesRendered"),v=Symbol("target");let w={};class x{constructor(e){this.context=void 0===e?this:e,this.name=null,this.handlers={}}on(e,t){let s=e.split("->");s.forEach(((e,t,s)=>s[t]=e.trim())),this.handlers.hasOwnProperty(s[0])||(this.handlers[s[0]]=new S(s[0])),this.handlers[s[0]].addHandler(t,s.length>1?s[1]:void 0)}off(e){let t=e.split("->");t.forEach(((e,t,s)=>s[t]=e.trim())),this.handlers.hasOwnProperty(t[0])&&(t.length>1&&t[1].length>0?this.handlers[t[0]].removePortHandler(t[1]):this.handlers[t[0]].removeAllHandlers())}trigger(e,...t){let s=e.split("->");s.forEach(((e,t,s)=>s[t]=e.trim())),this.handlers.hasOwnProperty(s[0])&&(s.length>1&&s[1].length>0?this.handlers[s[0]].runPortHandler(s[1],this.context,...t):this.handlers[s[0]].runAllHandlers(this.context,...t))}triggerDirect(e,...t){this.handlers.hasOwnProperty(e)&&this.handlers[e].runAllHandlers(this.context,...t)}static get(e,t){return w.hasOwnProperty(e)||(w[e]=new x(t),w[e].name=e),w[e]}}class S{constructor(e){this.eventName=e,this.handlers=[],this.ports={}}addHandler(e,t){void 0===t?this.handlers.push(e):this.ports[t]=e}removeAllHandlers(){this.handlers=[],this.ports={}}removePortHandler(e){delete this.ports[e]}runPortHandler(e,t,...s){this.ports.hasOwnProperty(e)&&this.ports[e].call(t,...s)}runAllHandlers(e,...t){for(let s=0;s<this.handlers.length;s++)this.handlers[s].call(e,...t);for(let s in this.ports)this.ports[s].call(e,...t)}}class E{constructor(){this[f]=new x(this)}on(e,t){this[f].on(e,t)}off(e,t){this[f].off(e,t)}trigger(e,...t){this[f].trigger(e,...t)}}class R extends E{constructor(){super(),this[g]=[]}}class C extends R{constructor(e){super();let t=i(e).toLowerCase();this.node=document.createElement(t),this.node[b]=this;let s=l(e);""!==s&&(this.node.id=s);let n=o(e).join(" ");""!==n&&(this.node.className=n),this.selector=t+(""===s?"":"#"+s)+(""===n?"":"."+n.replace(" ",".")),"input"!==t&&"textarea"!==t&&"select"!==t||Object.defineProperty(this,"value",{get(){return this.node.value},set(e){this.node.value=e}})}css(e,t){if("object"==typeof e)for(let t in e)this.node.style[t]=e[t];else this.node.style[e]=t}attr(e,t){if(void 0===t)return this.node.getAttribute(e);this.node.setAttribute(e,t)}node(){return this.node}}C.symbol=b;let k=["submit","abort","beforeinput","blur","click","compositionen","paste","compositionstart","compositionupdate","dblclick","error","focus","change","focusin","focusout","input","keydown","keypress","keyup","load","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mousewheel","mouseup","resize","scroll","select","unload","wheel","touchstart","touchend","touchmove"];function A(e,...t){let s=e.target;for(s.hasOwnProperty(b)&&(e.targetElement=s[b]);null!==s&&s.hasOwnProperty(b);)s[b][f].triggerDirect(e.type,e,...t),s=s.parentNode}for(let e=0,t=k.length;e<t;e++)document.addEventListener(k[e],A,{capture:!0});class P{constructor(e){this.cssObject=e,this.cssString="",this.styleNode=null,void 0===P.headNode&&(P.headNode=document.getElementsByTagName("head")[0])}renderFor(e,t){""!==this.cssString&&!0!==t||(this.cssString=P.renderRules(e,e.rootElement.selector,this.cssObject),null!==this.styleNode&&P.headNode.removeChild(this.styleNode),this.styleNode=document.createElement("style"),this.styleNode.textContent="\n"+this.cssString+"\n",P.headNode.appendChild(this.styleNode))}static renderRules(e,t,s){let n=t+" {\n",r="";for(let i in s){let o=s[i];if("string"==typeof o||"number"==typeof o)n+="    "+a(i)+": "+s[i]+";\n";else if(e[i]){let s=e[i]instanceof C?e[i]:e[i].rootElement;r+=P.renderRules(s,t+" > "+s.selector,o)}else":"===i[0]||"."===i[0]||"["===i[0]||"#"===i[0]||" "===i[0]||">"===i[0]?r+=P.renderRules(e,t+i,o):"@"===i[0]?r+=P.renderRules(e,i,o):n+=P.renderRules(e,i,o)}return n+"}\n"+r}}class O{constructor(e,t){"object"==typeof e&&(t=e,e=""),"object"!=typeof t&&(t={}),this[m]=a(i(e)),this[u]=l(e),this[c]=o(e),this[d]=t,this[h]=this[m],""!==this[u]&&(this[h]+="#"+this[u]),this[c].length>0&&(this[h]+="."+this[c].join("."))}static build(e,t){t=void 0===t||""===t?"":"."+a(t);let s=new C(e[h]+t),n=e[d];for(let e in n){"string"==typeof n[e]&&(n[e]=new O(n[e].indexOf(".")<0?n[e]+"."+e:n[e]));let t=a(e);n[e]instanceof O?(s[e]=O.build(n[e]),s[e].selector+="."+t,s[e].node.classList.add(t),s.node.appendChild(s[e].node)):"function"==typeof n[e].appendTo?(n[e].rootElement.selector+="."+t,n[e].rootElement.node.classList.add(t),n[e].appendTo(s),s[e]=n[e]):"object"==typeof n[e]&&(s[e]=O.build(new O(n[e])),s[e].selector+="."+t,s[e].node.classList.add(t),s.node.appendChild(s[e].node))}return s}}let z=0;class L extends R{constructor(e){super(),this.constructor.hasOwnProperty(p)||(this.constructor[p]=(z++,"uis-id-"+z));let t=this.defaultParams();if(this.params="object"==typeof e?e:{},"object"==typeof t&&"object"==typeof e)for(let e in t)this.params.hasOwnProperty(e)||(this.params[e]=t[e]);this.init(...arguments),this.render(this.params),this.constructor.hasOwnProperty(y)||(this.createStyles().renderFor(this,!1),this.constructor[y]=!0)}init(e){}createScheme(){return new O({})}onBeforeRender(e){}onRender(e){}render(e){this.onBeforeRender(e),this.trigger("beforeRender");let t=this.createScheme();"string"==typeof t?t=new O(t):t instanceof O||(t=new O("div",t));let s=t[c].join(" ");s=s.length<=1||"Function"===s?this.constructor[p]:"",this.rootElement=O.build(t,s);for(let e in this.rootElement)this.rootElement.hasOwnProperty(e)&&(this.rootElement[e]instanceof C||this.rootElement[e]instanceof L)&&(this[e]=this.rootElement[e]);return this.onRender(e),this.trigger("render"),this}onBeforeAppend(e){return e}appendTo(e){let t=this.onBeforeAppend(e);this.trigger("beforeAppend"),void 0!==t&&(e=t);let s=e;"string"==typeof e?s=document.querySelector(e):e instanceof C?s=e.node:e instanceof L&&(s=e.rootElement.node),s.appendChild(this.rootElement.node),this.onAppend(e),this.trigger("append",e)}onAppend(e){}onBeforeLoad(e){}onLoad(e,t){}onGather(e,t){}createStyles(){return new P({})}defaultParams(){return null}}class N extends L{init(e,t){this.params.text=e,this.params.color=t||N.PRIMARY}get disabled(){return this.rootElement.node.disabled}set disabled(e){this.rootElement.node.disabled=!0===e}createScheme(){return new O("button",{})}onRender(e){this.rootElement.node.textContent=e.text,this.rootElement.node.classList.add(e.color),this.rootElement.on("click",(e=>this.trigger("click",e)))}createStyles(){return new P({textAlign:"center",justifyContent:"center",flexShrink:0,height:"2.5rem",padding:"0.25rem 1.5rem",fontSize:"1rem",border:"none",borderRadius:"0.25rem",color:"#fff",cursor:"pointer",userSelect:"none",outline:"none",":disabled":{opacity:.5,pointerEvents:"none"},".primary":{backgroundColor:"#39f"},".red":{backgroundColor:"#ff3a3a"},".primary:hover":{backgroundColor:"#1f8fff"},".red:hover":{backgroundColor:"#eb2123"}})}}N.PRIMARY="primary",N.RED="red";class j extends L{init(e,t,s){this.params.placeholder=e,this.params.value=void 0===t?"":t,this.params.type=s||j.TEXT}createScheme(){return new O("label",{input:"input",label:"span.label"})}get value(){return this.input.node.value}set value(e){this.input.node.value=e,this.checkEmpty()}get disabled(){return this.input.node.disabled}set disabled(e){this.input.node.disabled=!0===e}focus(){this.input.node.focus()}checkEmpty(){""===this.input.node.value?this.input.node.classList.remove("not-empty"):this.input.node.classList.add("not-empty")}onRender(e){this.label.node.textContent=e.placeholder,this.input.node.value=e.value,this.input.node.setAttribute("type",e.type),this.checkEmpty(),this.input.on("change",(e=>{this.checkEmpty(),this.trigger("change",this.value,...arguments)})),this.input.on("input",(()=>{this.checkEmpty(),this.trigger("input",this.value,...arguments)}))}createStyles(){return new P({display:"flex",flexShrink:0,alignItems:"center",position:"relative",width:"100%",input:{display:"flex",padding:"0 0.75rem",width:"100%",height:"2.5rem",fontSize:"0.95rem",borderRadius:"0.25rem",border:"1px solid #ccc",outline:"none",":disabled":{opacity:.5,pointerEvents:"none"},":disabled + .label":{opacity:.5,pointerEvents:"none"},":focus":{borderColor:"#38a3fc",boxShadow:"0 0 0 1px #38a3fc"},".not-empty + .label":{top:"-0.75rem"},":focus + .label":{top:"-0.75rem"}},label:{position:"absolute",left:"0.4rem",top:"0.58rem",fontSize:"0.8rem",color:"#999",padding:"0.1rem 0.35rem",backgroundColor:"#fff",marginRight:"auto",transition:"0.25s",pointerEvents:"none"}})}}j.TEXT="text",j.NUMBER="number",j.EMAIL="email",j.PASSWORD="password";class T extends E{constructor(){super(),this[v]=null,this.init(arguments)}init(){}getTarget(){return this[v]}onApply(e){}onRemove(){}applyTo(t){if(null!==this[v])return s="Unable to apply extension: it's already applied.",void console.warn(e,s);var s;this[v]=t,t[g].push(this),this.onApply(t),this.trigger("apply",t)}remove(){if(null!==this[v]){let e=this[v],t=e[g];this.onRemove(e),this.trigger("remove",e);for(let e=0;e<t.length;e++)if(t[e]===this){t.splice(e,1);break}this[v]=null}}}window.UIScheme={UI:L,Scheme:O,Styles:P,EventsChannel:x,Localization:class{constructor(e){this.locale="en",this.translations=e||{},this[f]=new x,this.translate=(e,t)=>{let s=e;if(this.translations.hasOwnProperty(this.locale)&&this.translations[this.locale].hasOwnProperty(e)&&(s=this.translations[this.locale][e]),"object"==typeof t)for(let e in t)s=s.replace("{"+e+"}",t[e]);return s}}switchLocaleTo(e){this.locale=e,this.trigger("change",e)}on(e,t){this[f].on(e,t)}off(e,t){this[f].off(e,t)}trigger(e,...t){this[f].trigger(e,...t)}},builtIn:{ui:{Button:N,Input:j,Select:class extends L{init(e,t,s){this.params.placeholder=e,this.params.value=void 0===t?"":t,this.params.options=s||{}}createScheme(){return new O("label",{select:"select",label:"span.label"})}generateOptions(){this.select.node.innerHTML="";let e=document.createElement("option");this.select.node.appendChild(e);for(let e in this.params.options){let t=document.createElement("option");t.setAttribute("value",e),t.textContent=this.params.options[e],this.select.node.appendChild(t)}}setOptions(e){this.params.options=e,this.generateOptions()}get value(){return this.select.node.value}set value(e){this.select.node.value=e,this.checkEmpty()}get disabled(){return this.select.node.disabled}set disabled(e){this.select.node.disabled=!0===e}checkEmpty(){""===this.select.node.value?this.select.node.classList.remove("not-empty"):this.select.node.classList.add("not-empty")}onRender(e){this.label.node.textContent=e.placeholder,this.select.node.value=e.value,this.generateOptions(),this.checkEmpty(),this.select.on("change",(e=>{this.checkEmpty(),this.trigger("change",this.value,...arguments)}))}createStyles(){return new P({display:"flex",flexShrink:0,alignItems:"center",position:"relative",width:"100%",select:{display:"flex",padding:"0 0.75rem",width:"100%",height:"2.5rem",fontSize:"0.95rem",borderRadius:"0.25rem",border:"1px solid #ccc",outline:"none",":disabled":{opacity:.5,pointerEvents:"none"},":disabled + .label":{opacity:.5,pointerEvents:"none"},":focus":{borderColor:"#38a3fc",boxShadow:"0 0 0 1px #38a3fc"},".not-empty + .label":{top:"-0.75rem"}},label:{position:"absolute",left:"0.4rem",top:"0.58rem",fontSize:"0.8rem",color:"#999",padding:"0.1rem 0.35rem",backgroundColor:"#fff",marginRight:"auto",transition:"0.25s",pointerEvents:"none"}})}},ProgressBar:class extends L{init(e){e<0&&(e=0),e>100&&(e=100),this.params.value=e}createScheme(){return new O("div.progress-bar",{wrap:{bar:"div.bar"}})}get value(){return this.params.value}set value(e){e<0&&(e=0),e>100&&(e=100),this.params.value=e,this.wrap.bar.css("width",e+"%")}onRender(e){this.wrap.bar.css("width",e.value+"%")}createStyles(){return new P({display:"flex",flexGrow:1,wrap:{height:"0.5rem",width:"100%",border:"1px solid #999",bar:{height:"100%",width:0,backgroundColor:"#38a3fc"}}})}},LabeledText:class extends L{init(e,t,s){this.params.label=e,this.params.text=t,this.params.labelWidth=s||"auto"}get text(){return this.params.text}set text(e){this.params.text=e,this.textDiv.node.textContent=e}get label(){return this.params.label}set label(e){this.params.label=e,this.labelDiv.node.textContent=e}createScheme(){return new O("div.labeled-text",{labelDiv:"div.label",textDiv:"div.text"})}onRender(e){this.textDiv.node.textContent=e.text,this.labelDiv.node.textContent=e.label,"auto"!==e.labelWidth&&this.labelDiv.css("width",e.labelWidth+"rem")}createStyles(){return new P({display:"flex",alignItems:"center",labelDiv:{fontSize:"0.75rem",marginRight:"0.5rem",":after":{content:'":"'}},textDiv:{fontSize:"0.75rem"}})}},Spinner:class extends L{init(e,t){this.params.size=e||3,this.params.speed=t||360}createScheme(){return new O("div",{circle:"div"})}get size(){return this.params.size}set size(e){this.params.size=e,this.rootElement.css({width:this.params.size.toString()+"rem",height:this.params.size.toString()+"rem"})}get speed(){return this.params.speed}set speed(e){this.params.speed=e}onRender(e){this.size=e.size;let t=0,s=()=>{t+=e.speed/60,t>360&&(t-=360),this.rootElement.css("transform","rotate("+t+"deg)"),requestAnimationFrame(s)};requestAnimationFrame(s)}createStyles(){return new P({position:"relative",circle:{width:"80%",height:"80%",position:"absolute",left:"50%",top:"50%",marginLeft:"-40%",marginTop:"-40%",borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderTop:"5px solid #38a3fc",borderBottom:"5px solid #38a3fc",borderRadius:"100%"}})}}},extensions:{InputFilter:class extends T{init(e){this.regex=e,this.handler=null}onApply(e){let t=this.val();this.handler=s=>{this.regex.text(s)?t=s:e instanceof UI?e.value=t:e.node.value=t},e.on("input -> filter",this.handler),e.on("change -> filter",this.handler)}onRemove(e){e.off("input -> filter"),e.off("change -> filter")}}}}}}();
//# sourceMappingURL=ui-scheme.min.js.map

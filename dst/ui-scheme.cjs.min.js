'use strict';function warn(a){console.warn(a)}let allowedTagNames=["div","p","span","a","b","i","u","sup","sub","font","meta","form","label","input","select","option","textarea","button","ul","ol","li","table","tbody","thead","tr","td","img","video","source","canvas","script","style","title","h1","h2","h3","h4","h5","h6","blockquote","br","hr","main","section","article"],tagNameRegex=/(^|\s)\w+/ig,classNamesRegex=/\.\w+[_\-\w\d]*/ig,idRegex=/#\w+[_\-\w]*/ig;function parseTagName(a){let b=a.match(tagNameRegex);return(null!==b&&0<b.length&&(b=b[0]),null===b||0===b.length)?"div":(allowedTagNames.includes(b)||warn("Invalid tag name used: "+b),null==b?"div":b)}function parseClassNames(a){let b=a.match(classNamesRegex);if(null!==b&&0<b.length)for(let a=0;a<b.length;a++)b[a]=camelCaseToDashSeparated(b[a].slice(1));return null===b?[]:b}function parseId(a){let b=a.match(idRegex);return null!==b&&0<b.length?b[0].slice(1).trim():""}function splitByUpperCase(a){return a.replace(/([A-Z]+)/g,",$1").replace(/^,/,"").split(",")}function camelCaseToDashSeparated(a){return splitByUpperCase(a.replace(/\//g,"_").replace(" - ","-")).join("-").replace(/([a-zA-Z_-])\s+([a-zA-Z_\-\d])/g,"$1-$2").replace(/\s*-+\s*/gi,"-").replace(/-*_-*/gi,"_").toLowerCase()}let channels={};class EventsChannel{constructor(a){this.name=a,this.handlers={}}on(a,b){let c=a.split("->");c.forEach((b,c,d)=>d[c]=b.trim()),this.handlers.hasOwnProperty(c[0])||(this.handlers[c[0]]=new HandlersHub(c[0])),this.handlers[c[0]].addHandler(b,1<c.length?c[1]:void 0)}off(a){let b=a.split("->");b.forEach((b,c,d)=>d[c]=b.trim()),this.handlers.hasOwnProperty(b[0])&&(1<b.length&&0<b[1].length?this.handlers[b[0]].removePortHandler(b[1]):this.handlers[b[0]].removeAllHandlers())}trigger(a,...b){let c=a.split("->");c.forEach((b,c,d)=>d[c]=b.trim()),this.handlers.hasOwnProperty(c[0])&&(1<c.length&&0<c[1].length?this.handlers[c[0]].runPortHandler(c[1],this,...b):this.handlers[c[0]].runAllHandlers(this,...b))}static get(a){return channels.hasOwnProperty(a)||(channels[a]=new EventsChannel(a)),channels[a]}}class HandlersHub{constructor(a){this.eventName=a,this.handlers=[],this.ports={}}addHandler(a,b){b===void 0?this.handlers.push(a):this.ports[b]=a}removeAllHandlers(){this.handlers=[],this.ports={}}removePortHandler(a){delete this.ports[a]}runPortHandler(a,b,...c){this.ports.hasOwnProperty(a)&&this.ports[a].call(b,...c)}runAllHandlers(a,...b){for(let c=0;c<this.handlers.length;c++)this.handlers[c].call(a,...b);for(let c in this.ports)this.ports[c].call(a,...b)}}let elementSymbol=Symbol(),eventsSymbol=Symbol(),extSymbol=Symbol(),nativeEvents=["submit","abort","beforeinput","blur","click","compositionen","paste","compositionstart","compositionupdate","dblclick","error","focus","change","focusin","focusout","input","keydown","keypress","keyup","load","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mousewheel","mouseup","resize","scroll","select","unload","wheel","touchstart","touchend","touchmove"];function eventHook(a,...b){a.target.hasOwnProperty(elementSymbol)&&a.target[elementSymbol].trigger(a.type,a,...b)}for(let a=0,b=nativeEvents.length;a<b;a++)document.addEventListener(nativeEvents[a],eventHook,{capture:!0});class Element{constructor(a){this.node=document.createElement(parseTagName(a)),this.node[elementSymbol]=this;let b=parseId(a);""!==b&&(this.node.id=parseId(a));let c=parseClassNames(a);""!==c&&(this.node.className=c),this.selector=a,this[eventsSymbol]=new EventsChannel(eventsSymbol),this[extSymbol]={}}css(a,b){if("object"==typeof a)for(let b in a)this.node.style[b]=a[b];else this.node.style[a]=b}on(a,b){this[eventsSymbol].on(a,b)}off(a,b){this[eventsSymbol].off(a,b)}trigger(a,...b){this[eventsSymbol].trigger(a,...b)}attr(a,b){return void 0===b?this.node.getAttribute(a):void this.node.setAttribute(a,b)}node(){return this.node}}Element.symbol=elementSymbol;class Styles{constructor(a){this.cssObject=a,this.cssString="",this.styleNode=null,Styles.headNode===void 0&&(Styles.headNode=document.getElementsByTagName("head")[0])}renderFor(a,b){""!==this.cssString&&!0!==b||(this.cssString=Styles.renderRules(a,a.rootElement.selector,this.cssObject),null!==this.styleNode&&Styles.headNode.removeChild(this.styleNode),this.styleNode=document.createElement("style"),this.styleNode.textContent="\n"+this.cssString+"\n",Styles.headNode.appendChild(this.styleNode))}static renderRules(a,b,c){let d=b+" {\n",e="";for(let f in c){let g=c[f];if("string"==typeof g)d+="    "+camelCaseToDashSeparated(f)+": "+c[f]+";\n";else if(a[f]){let c=a[f]instanceof Element?a[f]:a[f].rootElement;e+=Styles.renderRules(c,b+" > "+c.selector,g)}else":"===f[0]&&(e+=Styles.renderRules(a,b+f,g))}return d+"}\n"+e}}let symbolSelector=Symbol("selector"),symbolData=Symbol("data"),symbolClasses=Symbol("classes"),symbolId=Symbol("id"),symbolTagName=Symbol("tagName");class Scheme{constructor(a,b){"object"==typeof a&&(b=a,a=""),"object"!=typeof b&&(b={}),this[symbolTagName]=camelCaseToDashSeparated(parseTagName(a)),this[symbolId]=parseId(a),this[symbolClasses]=parseClassNames(a),this[symbolData]=b,this[symbolSelector]=this[symbolTagName],""!==this[symbolId]&&(this[symbolSelector]+="#"+this[symbolId]),0<this[symbolClasses].length&&(this[symbolSelector]+="."+this[symbolClasses].join("."))}static build(a,b){b=void 0===b?"":"."+camelCaseToDashSeparated(b);let c=new Element(a[symbolSelector]+b),d=a[symbolData];for(let e in d)"string"==typeof d[e]&&(d[e]=new Scheme(0>d[e].indexOf(".")?d[e]+"."+e:d[e])),d[e]instanceof Scheme?(c[e]=Scheme.build(d[e]),c.node.appendChild(c[e].node)):"function"==typeof d[e].appendTo&&(d[e].appendTo(c),c[e]=d[e]);return c}}let eventsSymbol$1=Symbol();class UI{constructor(a){this[eventsSymbol$1]=new EventsChannel;let b=this.defaultParams();for(let c in this.params=a||{},"object"!=typeof a&&(this.params={}),b)this.params.hasOwnProperty(c)||(this.params[c]=b[c]);this.init(this.params),this.render(this.params),this.createStyles().renderFor(this,!1)}init(a){}on(a,b){this[eventsSymbol$1].on(a,b)}off(a,b){this[eventsSymbol$1].off(a,b)}trigger(a,...b){this[eventsSymbol$1].trigger(a,...b)}createScheme(){return new Scheme({})}onBeforeRender(a){}onRender(a){}render(a){this.onBeforeRender(a),this.trigger("beforeRender");let b=this.createScheme();for(let c in"string"==typeof b?b=new Scheme(b):!(b instanceof Scheme)&&(b=new Scheme("div",b)),this.rootElement=Scheme.build(b,this.constructor.name),this.rootElement)this.rootElement.hasOwnProperty(c)&&(this.rootElement[c]instanceof Element||this.rootElement[c]instanceof UI)&&(this[c]=this.rootElement[c]);return this.onRender(a),this.trigger("render"),this}onBeforeAppend(a){return a}appendTo(a){let b=this.onBeforeAppend(a);this.trigger("beforeAppend"),b!==void 0&&(a=b);let c=a;"string"==typeof a?c=document.querySelector(a):a instanceof Element?c=a.node:a instanceof UI&&(c=a.rootElement.node),c.appendChild(this.rootElement.node),this.onAppend(a),this.trigger("append",a)}onAppend(a){}onBeforeLoad(a){}onLoad(a,b){}onGather(a,b){}createStyles(){return new Styles({})}defaultParams(){return{}}}var cjs={UI:UI,Scheme:Scheme,Styles:Styles,EventsChannel:EventsChannel};module.exports=cjs;
//# sourceMappingURL=ui-scheme.cjs.min.js.map
